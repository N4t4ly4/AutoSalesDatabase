/*Create Tables/Relationships/Integrity Constraints*/

CREATE TABLE ZipCode (
	ZipCode CHAR(5) PRIMARY KEY NOT NULL,
	State VARCHAR(20)  NOT NULL,
	City VARCHAR(50) NOT NULL
)

CREATE TABLE PurchaseSource (
	PSID INT PRIMARY KEY IDENTITY(1,1) NOT NULL,
	PSNAME VARCHAR(50) NOT NULL,
	PSTYPE VARCHAR(50) NOT NULL,
	PSAddress VARCHAR(100) NOT NULL,
	PSPhone CHAR(10) NOT NULL,
	ZipCode CHAR(5) REFERENCES ZipCode(ZipCode) NOT NULL
)

CREATE TABLE Employee (
	EID INT PRIMARY KEY IDENTITY(1,1)  NOT NULL,
	EFirstName VARCHAR(50)  NOT NULL,
	ELastName VARCHAR(50)  NOT NULL,
	ETotalCommission MONEY   NOT NULL
)

CREATE TABLE Purchase (
	PID INT PRIMARY KEY IDENTITY(1,1)  NOT NULL,
	PDate DATE  NOT NULL,
	PPrice MONEY  NOT NULL,
	EID INT REFERENCES Employee(EID)  NOT NULL,
	PSID INT REFERENCES PurchaseSource(PSID)   NOT NULL
)

CREATE TABLE Customer (
	CID INT PRIMARY KEY IDENTITY(1,1)  NOT NULL,
	CFirstName VARCHAR(50)  NOT NULL,
	CLastName VARCHAR(50)  NOT NULL,
	CPhone CHAR(10)  NOT NULL,
	CAddress VARCHAR(100)  NOT NULL,
	CDOB DATE  NOT NULL,
	CTaxID CHAR(9),
	CAccountNumber VARCHAR(50),
	CGender VARCHAR(6)  NOT NULL,
	ZipCode CHAR(5) REFERENCES ZipCode(ZipCode)  NOT NULL
)

CREATE TABLE CustomerEmployment (
	CEID INT PRIMARY KEY IDENTITY (1,1)  NOT NULL,
	CEEmployer VARCHAR(200)  NOT NULL,
	CETitle VARCHAR(100)  NOT NULL,
	CEStart DATE  NOT NULL,
	CEEnd DATE  NULL,
	CECurrent VARCHAR(3)  NOT NULL,
	CEAddress VARCHAR(100),
	CEPhone CHAR(10)  NOT NULL,
	CESupervisor VARCHAR(100),
	ZipCode CHAR(5) REFERENCES ZipCode(ZipCode)  NOT NULL,
	CID INT REFERENCES Customer(CID)  NOT NULL
)

CREATE TABLE Sale (
	SID INT PRIMARY KEY IDENTITY(1,1)  NOT NULL,
	STotal MONEY  NOT NULL,
	SDate DATE  NOT NULL,
	SDownPayment MONEY  NOT NULL,
	SFinancedAmount MONEY  NOT NULL,
	SCommission MONEY  NOT NULL,
	SType VARCHAR(10)  NOT NULL,
	EID INT REFERENCES Employee(EID)  NOT NULL,
	CID INT REFERENCES Customer(CID)  NOT NULL
)

CREATE TABLE Vehicle (
	VIN CHAR(17) PRIMARY KEY  NOT NULL,
	VMAKE VARCHAR(50)  NOT NULL,
	VModel VARCHAR(50)  NOT NULL,
	VMiles INT  NOT NULL,
	VColor VARCHAR(30)  NOT NULL,
	VBookPrice Money  NOT NULL,
	VYear CHAR(4)  NOT NULL,
	VCondition VARCHAR(30)  NOT NULL,
	VInteriorColor VARCHAR(30)  NOT NULL,
	VListPrice MONEY  NOT NULL,
	VStyle VARCHAR(30)  NOT NULL,
	PID INT REFERENCES Purchase(PID)  NOT NULL,
	SID INT REFERENCES Sale(SID)   NOT NULL
)

CREATE TABLE VehicleProblem (
	VPID INT PRIMARY KEY IDENTITY(1,1)  NOT NULL,
	VPEstCost MONEY  NOT NULL,
	VPActualCost MONEY  NOT NULL,
	VPDescription VARCHAR(500)  NOT NULL,
	VIN CHAR(17) REFERENCES Vehicle(VIN)  NOT NULL
)

CREATE TABLE Warranty (
	WID INT PRIMARY KEY IDENTITY(1,1)  NOT NULL,
	WStartDate DATE  NOT NULL,
	WEndDate DATE  NOT NULL,
	WDeductable MONEY  NOT NULL,
	WItems VARCHAR(500)  NOT NULL,
	WSaleDate DATE  NOT NULL,
	WMonthlyTotal MONEY  NOT NULL,
	WTotalCost MONEY  NOT NULL,
	VIN CHAR(17) REFERENCES Vehicle(VIN)  NOT NULL,
	SID INT REFERENCES Sale(SID)  NOT NULL
)

CREATE TABLE CoSigner (
	COID INT PRIMARY KEY IDENTITY(1,1)  NOT NULL,
	COFIRSTNAME VARCHAR(50)  NOT NULL,
	COLastName VARCHAR(50)  NOT NULL,
	COTaxID CHAR(9)  NOT NULL,
	COPhone CHAR(10)  NOT NULL,
	COAddress VARCHAR(100)  NOT NULL,
	ZipCode CHAR(5) REFERENCES ZipCode(ZipCode)  NOT NULL,
	WID INT REFERENCES Warranty(WID)  NULL,
	SID INT REFERENCES Sale(SID)  NOT NULL
)

CREATE TABLE CustomerBalance (
	CBID INT PRIMARY KEY IDENTITY(1,1)  NOT NULL,
	CBTotalDue MONEY  NOT NULL,
	CBRemainingBalance MONEY  NOT NULL,
	CBDayofMonthDue INT  NOT NULL,
	SID INT REFERENCES Sale(SID)  NOT NULL,
	CID INT REFERENCES Customer(CID)  NOT NULL,
)

CREATE TABLE Payment (
	PAYID INT PRIMARY KEY IDENTITY(1,1)  NOT NULL,
	PAYAmountPaid MONEY  NOT NULL,
	PAYDate DATE  NOT NULL,
	PAYType VARCHAR(10)  NOT NULL,
	PAYDue MONEY  NOT NULL,
	CBID INT REFERENCES CustomerBalance(CBID)  NOT NULL
)
